<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meme Dodge Master üéÆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            color: white;
        }
        
        #gameTitle {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
            animation: pulse 2s infinite;
        }
        
        #scoreBoard {
            display: flex;
            gap: 30px;
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: bold;
        }
        
        #gameCanvas {
            border: 5px solid #ffd700;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            background: linear-gradient(135deg, #6366f1 0%, #a855f7 50%, #ec4899 100%);
        }
        
        #controls {
            margin-top: 20px;
            display: flex;
            gap: 15px;
        }
        
        button {
            padding: 15px 30px;
            font-size: 20px;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
        }
        
        button:hover:not(:disabled) {
            transform: scale(1.1);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        #upBtn, #downBtn {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
        }
        
        #soundBtn {
            background: linear-gradient(135deg, #6b7280, #374151);
        }
        
        #shareBtn {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body>
    <div id="gameTitle">üéÆ MEME DODGE MASTER üéÆ</div>
    <div id="scoreBoard">
        <div>Score: <span id="score">0</span> üèÜ</div>
        <div>Best: <span id="highScore">0</span> üëë</div>
    </div>
    
    <canvas id="gameCanvas" width="800" height="500"></canvas>
    
    <div id="controls">
        <button id="upBtn">‚¨ÜÔ∏è UP</button>
        <button id="downBtn">‚¨áÔ∏è DOWN</button>
        <button id="soundBtn">üîä SOUND ON</button>
        <button id="shareBtn" style="display:none;">üì§ SHARE</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const highScoreEl = document.getElementById('highScore');
        const upBtn = document.getElementById('upBtn');
        const downBtn = document.getElementById('downBtn');
        const soundBtn = document.getElementById('soundBtn');
        const shareBtn = document.getElementById('shareBtn');

        let gameState = {
            started: false,
            over: false,
            playerY: 250,
            obstacles: [],
            particles: [],
            score: 0,
            highScore: parseInt(localStorage.getItem('memeDodgeHighScore') || '0'),
            muted: false,
            deathEmoji: '',
            gameLoop: null
        };

        const MEMES = ['üíÄ', 'ü§°', 'üî•', 'üí©', 'üëª', 'ü§ñ', 'üòé', 'ü¶Ñ'];
        const LANES = [50, 130, 210, 290, 370, 450];
        
        const SOUNDS = {
            'üíÄ': 'OH NO NO NO',
            'ü§°': 'EMOTIONAL DAMAGE',
            'üî•': 'FIRE IN THE HOLE',
            'üí©': 'BRUHHH',
            'üëª': 'BOO',
            'ü§ñ': 'BEEP BOOP ERROR',
            'üòé': 'SHEEESH',
            'ü¶Ñ': 'RAINBOW FAIL'
        };

        highScoreEl.textContent = gameState.highScore;

        function playSound(text) {
            if (gameState.muted) return;
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 1.2;
            utterance.pitch = 0.8;
            window.speechSynthesis.cancel();
            window.speechSynthesis.speak(utterance);
        }

        function playTone(freq, duration) {
            if (gameState.muted) return;
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.frequency.value = freq;
            gain.gain.value = 0.2;
            osc.start();
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            osc.stop(audioCtx.currentTime + duration);
        }

        function movePlayer(direction) {
            if (!gameState.started || gameState.over) return;
            playTone(500, 0.1);
            if (direction === 'up') {
                gameState.playerY = Math.max(50, gameState.playerY - 80);
            } else {
                gameState.playerY = Math.min(450, gameState.playerY + 80);
            }
        }

        function createParticles(x, y, emoji) {
            for (let i = 0; i < 15; i++) {
                gameState.particles.push({
                    x, y,
                    vx: (Math.random() - 0.5) * 10,
                    vy: (Math.random() - 0.5) * 10,
                    emoji,
                    life: 1,
                    rotation: Math.random() * 360
                });
            }
        }

        function startGame() {
            gameState.started = true;
            gameState.over = false;
            gameState.playerY = 250;
            gameState.obstacles = [];
            gameState.particles = [];
            gameState.score = 0;
            gameState.deathEmoji = '';
            scoreEl.textContent = '0';
            shareBtn.style.display = 'none';
            upBtn.disabled = false;
            downBtn.disabled = false;
            playTone(600, 0.1);
            
            gameState.gameLoop = setInterval(gameLoop, 30);
        }

        function gameLoop() {
            // Update obstacles
            gameState.obstacles = gameState.obstacles
                .map(obs => ({ ...obs, x: obs.x - 8 }))
                .filter(obs => obs.x > -100);

            // Spawn new obstacles
            if (Math.random() < 0.02) {
                gameState.obstacles.push({
                    x: 850,
                    y: LANES[Math.floor(Math.random() * LANES.length)],
                    emoji: MEMES[Math.floor(Math.random() * MEMES.length)],
                    scored: false
                });
            }

            // Update particles
            gameState.particles = gameState.particles
                .map(p => ({
                    ...p,
                    x: p.x + p.vx,
                    y: p.y + p.vy,
                    vy: p.vy + 0.3,
                    life: p.life - 0.015,
                    rotation: p.rotation + 10
                }))
                .filter(p => p.life > 0);

            // Check collisions
            const collision = gameState.obstacles.find(obs => {
                const dx = Math.abs(obs.x - 100);
                const dy = Math.abs(obs.y - gameState.playerY);
                return dx < 40 && dy < 35;
            });

            if (collision) {
                gameOver(collision.emoji, collision.x, collision.y);
                return;
            }

            // Score points
            gameState.obstacles.forEach(obs => {
                if (!obs.scored && obs.x < 100) {
                    obs.scored = true;
                    gameState.score++;
                    scoreEl.textContent = gameState.score;
                    playTone(800, 0.1);
                }
            });

            draw();
        }

        function gameOver(emoji, x, y) {
            gameState.over = true;
            gameState.deathEmoji = emoji;
            clearInterval(gameState.gameLoop);
            
            createParticles(x, y, emoji);
            playSound(SOUNDS[emoji] || 'GAME OVER');
            
            if (gameState.score > gameState.highScore) {
                gameState.highScore = gameState.score;
                localStorage.setItem('memeDodgeHighScore', gameState.score);
                highScoreEl.textContent = gameState.highScore;
            }
            
            upBtn.disabled = true;
            downBtn.disabled = true;
            shareBtn.style.display = 'block';
            
            setTimeout(() => draw(), 100);
        }

        function draw() {
            // Clear canvas
            ctx.fillStyle = 'rgba(99, 102, 241, 0.1)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw stars
            ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
            for (let i = 0; i < 20; i++) {
                const x = (i * 37 + Date.now() / 50) % canvas.width;
                const y = (i * 43) % canvas.height;
                ctx.fillRect(x, y, 2, 2);
            }

            if (!gameState.started) {
                // Start screen
                ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.font = 'bold 60px Arial';
                ctx.fillStyle = 'white';
                ctx.textAlign = 'center';
                ctx.fillText('üéØ', canvas.width / 2, 150);
                
                ctx.font = 'bold 40px Arial';
                ctx.fillText('DODGE THE MEMES!', canvas.width / 2, 220);
                
                ctx.font = '24px Arial';
                ctx.fillStyle = '#ffd700';
                ctx.fillText('‚¨ÜÔ∏è Arrow UP / W - Move Up', canvas.width / 2, 280);
                ctx.fillText('‚¨áÔ∏è Arrow DOWN / S - Move Down', canvas.width / 2, 320);
                
                ctx.fillStyle = 'white';
                ctx.font = '20px Arial';
                ctx.fillText('üéµ Setiap emoji punya suara meme unik!', canvas.width / 2, 370);
                ctx.fillText('üèÜ Challenge teman-teman kamu!', canvas.width / 2, 400);
                
                ctx.font = 'bold 28px Arial';
                ctx.fillStyle = '#4ade80';
                ctx.fillText('Klik START GAME atau tekan SPACE', canvas.width / 2, 460);
                
            } else if (gameState.over) {
                // Game over screen
                ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                ctx.font = '80px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(gameState.deathEmoji, canvas.width / 2, 120);
                
                ctx.font = 'bold 50px Arial';
                ctx.fillStyle = '#ef4444';
                ctx.fillText('GAME OVER!', canvas.width / 2, 190);
                
                if (gameState.score === gameState.highScore && gameState.score > 0) {
                    ctx.font = 'bold 30px Arial';
                    ctx.fillStyle = '#ffd700';
                    ctx.fillText('üéâ NEW HIGH SCORE! üéâ', canvas.width / 2, 240);
                }
                
                ctx.font = '32px Arial';
                ctx.fillStyle = 'white';
                ctx.fillText('Score: ' + gameState.score + ' üèÜ', canvas.width / 2, 300);
                
                ctx.font = '24px Arial';
                ctx.fillStyle = '#d1d5db';
                ctx.fillText('High Score: ' + gameState.highScore + ' üëë', canvas.width / 2, 340);
                
                ctx.font = 'bold 28px Arial';
                ctx.fillStyle = '#a78bfa';
                ctx.fillText('Tekan SPACE untuk main lagi', canvas.width / 2, 420);
                
            } else {
                // Draw player
                ctx.font = '50px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('üöÄ', 100, gameState.playerY + 15);
                
                // Draw obstacles
                ctx.font = '40px Arial';
                gameState.obstacles.forEach(obs => {
                    ctx.fillText(obs.emoji, obs.x, obs.y + 10);
                });
            }

            // Draw particles
            ctx.font = '30px Arial';
            gameState.particles.forEach(p => {
                ctx.save();
                ctx.globalAlpha = p.life;
                ctx.translate(p.x, p.y);
                ctx.rotate(p.rotation * Math.PI / 180);
                ctx.fillText(p.emoji, 0, 0);
                ctx.restore();
            });
        }

        // Event listeners
        upBtn.addEventListener('click', () => movePlayer('up'));
        downBtn.addEventListener('click', () => movePlayer('down'));
        
        soundBtn.addEventListener('click', () => {
            gameState.muted = !gameState.muted;
            soundBtn.textContent = gameState.muted ? 'üîá MUTED' : 'üîä SOUND ON';
        });

        shareBtn.addEventListener('click', async () => {
            const text = `üéÆ Saya dapat score ${gameState.score} di Meme Dodge Master! Bisa kalahkan? üèÜ\n\n${window.location.href}`;
            if (navigator.share) {
                try {
                    await navigator.share({ title: 'Meme Dodge Master', text, url: window.location.href });
                } catch (e) {}
            } else {
                try {
                    await navigator.clipboard.writeText(text);
                    alert('Link berhasil dicopy! üìã');
                } catch (e) {
                    alert('Link: ' + window.location.href);
                }
            }
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowUp' || e.key === 'w' || e.key === 'W') {
                movePlayer('up');
            } else if (e.key === 'ArrowDown' || e.key === 's' || e.key === 'S') {
                movePlayer('down');
            } else if (e.key === ' ') {
                e.preventDefault();
                if (!gameState.started || gameState.over) {
                    startGame();
                }
            }
        });

        // Initial draw
        draw();
        
        // Animation loop for start/end screens
        setInterval(() => {
            if (!gameState.started || gameState.over) {
                draw();
            }
        }, 100);
    </script>
</body>
</html>
